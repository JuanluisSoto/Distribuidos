<!DOCTYPE html>
<html lang="es">

<head>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    var bucketurl = "https://samanta.barros.sisdis2023.s3.us-east-1.amazonaws.com/";
    $(document).ready(function () {
      var usuarioJSON = localStorage.getItem('usuario');
      // Convierte la cadena JSON de vuelta a un objeto
      var usuario = JSON.parse(usuarioJSON);
      var user = usuario.nombre;

      var sendPost = $.post(
        "https://6eohrnaumtlb53gtrs3prss6lq0scjob.lambda-url.us-east-1.on.aws/",
        { user: user },
        function (data) {
          var json = data;

          for (let i in json.posts) {
            user = json.posts[i].name;
            var ul = $("#comment_list");
            var li = $("<li>").addClass("list-group-item");
            var comment = $("<p>").text(user + " dice: " + json.posts[i].comment).addClass("mb-0");

            if (json.posts[i].tipo == "img") {
              var image = $("<img>").attr({
                "width": "320",
                "height": "320",
                "src": bucketurl + json.posts[i].attachment
              });

              ul.append(li.append(comment).append(image));
            } else {
              var video = $("<video>").attr({
                "width": "320",
                "height": "240",
                "controls": true
              });

              var source = $("<source>").attr({
                "src": bucketurl + json.posts[i].attachment,
                "type": "video/mp4"
              });

              video.append(source);
              ul.append(li.append(comment).append(video));
            }
          }
        }
      )
    });

  </script>

</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#">Twitter</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ml-auto">
            <li class="nav-item active">
                <a class="nav-link"
                    href="https://samanta.barros.sisdis2023.s3.us-east-1.amazonaws.com/readPosts.html">Inicio
                    <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link"
                    href="https://samanta.barros.sisdis2023.s3.us-east-1.amazonaws.com/readPostUser.html">Perfil</a>
            </li>
            <li class="nav-item">
                <a class="nav-link"
                    href="https://samanta.barros.sisdis2023.s3.us-east-1.amazonaws.com/busqueda.html">Buscar Usuarios</a>
            </li>
            <li class="nav-item">
                <a class="nav-link"
                    href="https://samanta.barros.sisdis2023.s3.us-east-1.amazonaws.com/postComment.html">publicar
                    mensaje</a>
            </li>
            <li class="nav-item">
                <a class="nav-link"
                    href="https://samanta.barros.sisdis2023.s3.us-east-1.amazonaws.com/login.html">login</a>
            </li>
            <li class="nav-item">
                <a class="nav-link"
                    href="https://samanta.barros.sisdis2023.s3.us-east-1.amazonaws.com/Register.html">Registrarse</a>
            </li>
            <!-- Puedes agregar más elementos según sea necesario -->
        </ul>
    </div>
</nav>

  <ul id="comment_list" class="list-group mt-3">
    <!-- Contenido generado dinámicamente -->
  </ul>
</body>

</html>
